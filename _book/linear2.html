<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Linear regression (2) – Advanced Statistical Methods for Analyzing Empirical Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./presentations.html" rel="next">
<link href="./linear1.html" rel="prev">
<link href="./images/cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="site_libs/datatables-binding-0.33/datatables.js"></script>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="site_libs/dt-ext-scroller-1.13.6/css/scroller.dataTables.min.css" rel="stylesheet">

<script src="site_libs/dt-ext-scroller-1.13.6/js/dataTables.scroller.min.js"></script>

<link href="site_libs/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">

<script src="site_libs/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script>

<script src="site_libs/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script>

<script src="site_libs/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script>

<script src="site_libs/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script>

<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./linear2.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Linear regression (2)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Advanced Statistical Methods for Analyzing Empirical Data</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Jamovi and data preparation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">ANOVA Designs (1)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">ANOVA Designs (2)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">ANOVA Designs (3)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Linear regression (1)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Linear regression (2)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./presentations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Presentations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#multiple-linear-regression-model" id="toc-multiple-linear-regression-model" class="nav-link active" data-scroll-target="#multiple-linear-regression-model"><span class="header-section-number">6.1</span> Multiple linear regression model</a></li>
  <li><a href="#basic-criteria-for-model-selection" id="toc-basic-criteria-for-model-selection" class="nav-link" data-scroll-target="#basic-criteria-for-model-selection"><span class="header-section-number">6.2</span> Basic criteria for model selection</a></li>
  <li><a href="#strategies-for-model-selection" id="toc-strategies-for-model-selection" class="nav-link" data-scroll-target="#strategies-for-model-selection"><span class="header-section-number">6.3</span> Strategies for model selection</a></li>
  <li><a href="#importing-data" id="toc-importing-data" class="nav-link" data-scroll-target="#importing-data"><span class="header-section-number">6.4</span> Importing data</a></li>
  <li><a href="#simultaneous-regression" id="toc-simultaneous-regression" class="nav-link" data-scroll-target="#simultaneous-regression"><span class="header-section-number">6.5</span> Simultaneous Regression</a>
  <ul class="collapse">
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions"><span class="header-section-number">6.5.1</span> Assumptions</a></li>
  <li><a href="#normality-of-the-residuals" id="toc-normality-of-the-residuals" class="nav-link" data-scroll-target="#normality-of-the-residuals"><span class="header-section-number">6.5.2</span> Normality of the residuals</a></li>
  <li><a href="#no-multicollinearity" id="toc-no-multicollinearity" class="nav-link" data-scroll-target="#no-multicollinearity"><span class="header-section-number">6.5.3</span> No multicollinearity</a></li>
  <li><a href="#no-outliers-that-influence-the-model-influential-points" id="toc-no-outliers-that-influence-the-model-influential-points" class="nav-link" data-scroll-target="#no-outliers-that-influence-the-model-influential-points"><span class="header-section-number">6.5.4</span> No outliers that influence the model (influential points)</a></li>
  <li><a href="#the-model-fit-and-coefficients" id="toc-the-model-fit-and-coefficients" class="nav-link" data-scroll-target="#the-model-fit-and-coefficients"><span class="header-section-number">6.5.5</span> The model fit and coefficients</a></li>
  </ul></li>
  <li><a href="#hierarchical-regression" id="toc-hierarchical-regression" class="nav-link" data-scroll-target="#hierarchical-regression"><span class="header-section-number">6.6</span> Hierarchical regression</a>
  <ul class="collapse">
  <li><a href="#model-1" id="toc-model-1" class="nav-link" data-scroll-target="#model-1"><span class="header-section-number">6.6.1</span> Model 1</a></li>
  <li><a href="#model-2" id="toc-model-2" class="nav-link" data-scroll-target="#model-2"><span class="header-section-number">6.6.2</span> Model 2</a></li>
  <li><a href="#model-3" id="toc-model-3" class="nav-link" data-scroll-target="#model-3"><span class="header-section-number">6.6.3</span> Model 3</a></li>
  </ul></li>
  <li><a href="#model-with-interaction" id="toc-model-with-interaction" class="nav-link" data-scroll-target="#model-with-interaction"><span class="header-section-number">6.7</span> Model with interaction</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-linear2" class="quarto-section-identifier"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Linear regression (2)</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>When we have finished this chapter, we should be able to:</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning objectives
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Fit and interpret multiple linear models</li>
<li>Assess the quality of a linear regression fit</li>
<li>Compare linear models</li>
</ul>
</div>
</div>
<section id="multiple-linear-regression-model" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="multiple-linear-regression-model"><span class="header-section-number">6.1</span> Multiple linear regression model</h2>
<p>Although multivariable regression may appear complex, its concepts, computations, and interpretations are direct extensions of those in simple regression.</p>
<p>The general form of a linear regression model is given by:</p>
<p><span id="eq-line21"><span class="math display">\[\widehat{y} = b_o  + b_1 \cdot x_1 + b_2 \cdot x_2 + b_3 \cdot x_3 + ...+b_p \cdot x_p \tag{6.1}\]</span></span></p>
<p>The objective is to obtain the coefficients-also known as partial regression slopes- <span class="math inline">\(b_o, b_1, b_2, b_3,...,b_p\)</span>.</p>
<p>It is important to emphasize that the term “linear” refers to the model’s linearity in the coefficients b, rather than in the explanatory variables x. For example, the following is still considered a <strong>general</strong> linear model:</p>
<p><span id="eq-line22"><span class="math display">\[\widehat{y} = b_o  + b_1 \cdot x_1 + b_2 \cdot x_2 + b_3 \cdot x_1 \cdot x_2 + b_4 \cdot x_1^2 \tag{6.2}\]</span></span></p>
<p>For example, in <a href="#fig-linear3d" class="quarto-xref">Figure&nbsp;<span>6.1</span></a> we present a model consisted of one response variable (weight) and two continuous explanatory variables (height, headc):</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{y}} &amp;= b_o + b_1 \cdot x_1 + b_2 \cdot x_2\\
\widehat{\text{weight}} &amp;= b_o + b_1 \cdot \text{height} + b_2 \cdot \text{headc}
\end{aligned}
\]</span></p>
<div id="fig-linear3d" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linear3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/linear3d.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linear3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.1: For a model consisted of one response variable and two explanatory variables a plane in three-dimensional space may be fitted to the data points.
</figcaption>
</figure>
</div>
<p>We have visualized some of the points as being located above the plane and some as being located below the plane. The deviation of a point from the plane is represented by the dashed red line and is the residual. When the model contains more than two independent variables, it is described geometrically as a hyperplane.</p>
<p>It is important to note that the residuals in linear regression are assumed to be independent and identically distributed following the normal distribution with mean equals to zero and constant variance.</p>
</section>
<section id="basic-criteria-for-model-selection" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="basic-criteria-for-model-selection"><span class="header-section-number">6.2</span> Basic criteria for model selection</h2>
<p>In simple linear regression, there is only one possible model, as it involves a single explanatory variable. However, in multiple linear regression, where multiple explanatory variables are involved, the challenge becomes identifying the best model. But what does “best” really mean?</p>
<p>Should we select a model with only a few explanatory variables, or include as many as possible? For instance, if we have 20 potential explanatory variables, should we use all of them—or just a subset? And if we choose to use a subset, how do we decide which variables to include in order to optimize a particular function or goal?</p>
<p>Surprisingly, these questions do not have straightforward answers—even for experienced researchers and data analysts. Variable selection in regression modeling is a complex task, and there is no universal agreement on the best approach. As we’ll see, choosing the “best” model often depends as much on scientific or practical considerations as on statistical criteria.</p>
<p>A fundamental principle in model selection is the preference for simplicity. When comparing two models that explain the data equally well, the simpler model is generally favored. This principle, known as Occam’s Razor (or the law of parsimony), is widely embraced across scientific disciplines, including statistics.</p>
<blockquote class="blockquote">
<p><strong>Parcimonious model:</strong> We typically prefer simpler models, provided they account for similar amounts of variance as more complex ones.</p>
</blockquote>
<p>The idea behind a parsimonious model is to avoid overfitting, where a model becomes too complex and starts to capture noise rather than the underlying patterns in the data. A parsimonious model aims to find a balance between complexity and performance, ensuring that the model is neither too simple (underfitting) nor too complex (overfitting).</p>
</section>
<section id="strategies-for-model-selection" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="strategies-for-model-selection"><span class="header-section-number">6.3</span> Strategies for model selection</h2>
<p>Next we present some commonly used strategies for model selection:</p>
<ul>
<li><strong>Simultaneous Regression</strong></li>
</ul>
<p>The first and most straightforward approach to model selection is to include all available explanatory variables and assess model fit based on this complete model. This is known as full entry or simultaneous regression. In this method, the regression model is built by estimating all parameters simultaneously. However, there are cases where full-entry or simultaneous regression may not be the best choice for model-building. In such instances, the researcher may prefer to adopt a more complex algorithm for constructing the regression model.</p>
<ul>
<li><strong>Hierarchical Regression</strong></li>
</ul>
<p>In hierarchical regression, unlike in simultaneous regression, where all explanatory variables are entered into the model at once, researchers typically follow a pre-specified order for introducing variables creating multiple models or blocks. The order is usually driven by theory, reflecting the researcher’s prior knowledge. Hierarchical regression is particularly popular among social scientists when testing mediational hypotheses.</p>
<ul>
<li><strong>Automated regression methods (Best subset selection)</strong></li>
</ul>
<p>(<strong>NOTE:</strong> This approach is not supported by JAMOVI.)</p>
<p>These methods combine the explanatory variables in all possible ways. The best subset selection (using backward elimination, forward selection, or both[stepwise selection]) seek to find the best model according to statistical criteria in many steps (stepwise method, the model is re-avaluated in each step). However, as you might imagine, the number of possible models quickly becomes quite large.</p>
<p>It is important to note that several statistical criteria can be used to assess the efficiency or fit of a model, with penalties for the number of explanatory variables. These criteria are calculated and compared across a set of competing models, providing an objective basis for selecting the “best” regression model. Examples include adjusted R-squared, Akaike Information Criterion (AIC)—where a smaller AIC indicates a better model—and Bayesian Information Criterion (BIC).</p>
<p>At first glance, especially for those new to statistics, automated selection methods may seem like an ideal solution for many multiple regression problems. They can appear to be the “panacea” for model selection—after all, allowing the computer to determine the “correct” model using its complex computational abilities seems like a logical approach.</p>
<p>However, the issue is not as straightforward as it may seem, and several statistical and substantive challenges complicate the application of these methods. While automation offers convenience, it also has significant drawbacks, and not all decisions can or should be left to a computer. In addition to these statistical issues, there are substantive considerations to account for when selecting a model. The final model chosen by automated methods may not always offer the most practical value or utility.</p>
<p>From a statistical perspective, automated selection methods, such as forward and backward regression, can introduce bias into parameter estimates, making the resulting inferential model unreliable. After multiple iterations, the probability of a Type I error becomes higher than the nominal <span class="math inline">\(\alpha\)</span> (typically 0.05). In addition to these statistical issues, there are substantive considerations to account for when selecting a model. The final model chosen by automated methods may not always offer the most practical value or utility.</p>
<blockquote class="blockquote">
<p><strong>Maximizing statistical criteria is not the same as maximizing utility of the model.</strong></p>
</blockquote>
<ul>
<li><strong>Purposeful selection process</strong></li>
</ul>
<p>The purposeful selection process begins with a univariable analysis of each candidate variable. A general decision rule is then applied to determine which variables to include. For example, any variable with a p-value &lt; 0.20 in the univariable analysis may be selected for the multivariable analysis.</p>
<p>However, since the primary goal of a multivariable model is typically to assess the effect of the study intervention while controlling for potential confounders, variable selection should also take into account existing knowledge and the clinical significance of the variables. If necessary, the initial rule can be adjusted. For example, a potential confounder may be included in the model if it alters the coefficient of the primary exposure variable by 10% in the multivariable model.</p>
</section>
<section id="importing-data" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="importing-data"><span class="header-section-number">6.4</span> Importing data</h2>
<p>Continuing from the previous chapter, we will work with the <em>BirthWeight</em> dataset. This time, we aim to explore the association between infant weight and all other measured explanatory variables.</p>
<div class="cell">
<div id="fig-BirthWeight0" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-BirthWeight0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="datatables html-widget html-fill-item" id="htmlwidget-abea56ec2407864b0dc9" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-abea56ec2407864b0dc9">{"x":{"filter":"none","vertical":false,"extensions":["Scroller","Buttons"],"data":[[3950,4630,4750,3920,4559,3639,3550,4530,4969,3740,4190,4350,4619,4089,4420,5619,5250,4320,4409,4179,4290,4670,3970,4570,4529,4179,4779,3719,4530,4460,4110,4000,3419,4949,3300,4520,4070,4539,4049,3339,4769,4210,4259,3880,4360,4650,5400,3900,4239,3740,3700,4340,4610,4600,4889,3690,4469,5139,4769,4500,5340,3530,5020,5019,5449,5809,3659,3340,4199,4600,4840,3960,4259,3510,4619,5690,4519,3109,3790,4010,3540,4480,4920,4929,3900,4089,4589,4389,4989,4180,4119,3789,3989,4619,3480,4900,4259,4880,4059,4270,4679,4029,4100,4860,4700,3770,4010,4469,4780,4219,4730,4389,4600,4150,3740,3949,3880,5110,3050,3450,4520,3820,4400,3790,5019,5200,4739,3770,4269,4409,5550,4080,3590,5030,3850,4010,4909,5130,4980,4319,4270,5539,4350,4530,4920,3800,3890,3960,3850,3900,5179,4009,4449,5239,4319,5590,4290,3709,3359,3540,4519,3689,4509,3940,5000,3750,3980,4219,5500,4800,3889,4340,4320,3980,4559,5000,3619,4330,4670,5239,4589,4059,4610,4810,4739,4360,4069,4460,4460,4230,3960,4360,3840,4779,3719,5429,4489,4699,5309,4190,5179,4339,4070,4110,3500,4750,6329,5920,5409,4059,2919,4730,3730,3010,4180,4860,3700,3199,4000,4349,5449,3660,4559,4120,5079,3720,5049,4949,4389,4679,4319,3369,3550,5750,4889,4279,4860,3900,3950,4909,3129,5199,5230,4509,4339,3599,4980,4549,4270,4179,3679,3079,4900,4100,5409,5219,4449,4020,5480,4830,4300,4349,3760,4380,5179,5259,4630,4080,4230,3540,5820,5119,4030,5039,4080,5130,3960,5029,4060,4059,4039,3310,5429,3559,5269,4540,4050,5279,5329,3609,4639,4440,5280,4130,5260,3969,4699,3730,4409,4980,3689,4589,4489,4969,3990,4089,4199,3459,3179,4610,3669,4099,3279,4320,4700,4570,3580,4099,4600,4789,3780,4319,4330,4750,5190,4250,4049,4179,4039,4650,2980,4800,4300,4110,4759,3380,4049,4489,4699,4250,3719,3169,5059,3900,4130,3420,4010,4210,4630,5139,4869,4400,3989,4000,4800,4780,4440,3510,3369,3789,5019,3929,4580,3800,3929,4440,3810,3850,4500,3670,3839,3200,3369,5099,4890,4869,4610,4219,3669,4000,3900,3720,4679,3850,5300,4440,5320,4329,4750,4460,4139,4179,4150,5389,4139,4069,4770,4199,3850,4530,4409,4690,3510,3410,3679,3869,4829,5559,4469,3989,4699,3589,4060,4130,5170,3940,3330,4700,5119,4760,4810,4500,4789,5309,4199,3989,4900,3679,4270,3869,4739,3340,5289,4789,4630,5050,5099,4120,4699,3880,4040,4770,3309,4869,4549,3880,4610,4270,4790,4520,4230,5599,4009,3480,4650,4940,4219,4800,3789,4519,3909,3800,3680,4800,4750,4800,5050,3989,5159,4659,4619,3869,4520,4179,3859,4500,5079,4089,4110,4139,4130,3410,3810,4420,4070,3359,4029,4869,4750,4130,4920,4179,4730,5750,3789,4309,3679,4170,5210,3010,5250,4500,4840,3730,5550,4269,3949,4800,3590,3500,4760,3719,4500,4329,4510,4020,3699,4119,4440,5139,3090,5400,4520,4679,5760,4179,4019,3409,4670,4599,4230,3240,4210,4170,4949,4610,5329,3709,6489,5090,5429,4750,4900,3740,4320,5349,5389,3880,5230,4569],[55.5,57,56,56,55,51.5,56,57,58.5,52,54,59,56,53,57,58,58,54.5,57,53.5,55,54.5,53.5,59,56,56.5,58,52,55.5,58.5,53.5,54.5,51.5,56,52,55,53.5,59,54,50,56,54.5,54,52.5,52,55.5,58,52,57,51.5,52,57,56,56,57.5,54.5,53,62,56,58,58,51,56,56,58,56,51,55,52,55,56,57,53,51,56,59,52.5,51,52.5,55,52,57,56,56.5,53,54,56.5,55,59.5,52,54,51,50,57,54,57,54.5,57,54,53,56,52,53,55,56,53,54,56,56,53.5,54,51,56,48,51,51,52,58,52,51,52,55,55,55,54.5,59,56.5,51.5,55,58,60.5,53.8,52,58,53,53,54,56,57.5,57,55.8,58,56,56,56,57,54,54,57,54,57.5,54,56,59,56,59,56,52.5,51,53,53,53,53,58,57,54,53,55,59,56.5,52,55.5,55,52,53,58.5,52,59,54,57,54,55,56,57,55.5,55,54,57,54,54.5,53,53,54,58,52,57.5,56,55,60,53,56,56,55,52,56,56,59,56,57,56,49,55.5,53,53,59.5,56,54,52,53,54.5,58,52,54,50.5,57,52,57,56,52,53,59,50.5,51,60.5,56,54,60,54,52,59,50,56,53,54,54,53,58,54,49.5,53,52.5,50.5,59,54,61,54,52,54,55.5,56,55,54,53,55,57.5,60.5,56,55,53,51.5,62,61,51,57,56,57,53,57,53.5,58,53,51,61,53.5,58,53.5,57,58,56.5,55,57.5,56,54,53.5,58.5,52.5,57,53,55.5,57.5,53.5,54,51.5,57.5,52,54.5,54.5,52,55,57.5,53.5,50.5,50,55.5,55,58,55,52.5,56.5,56.5,53,52,53,58,53.5,53,53.5,53,53,56,51,54,54,54,55,51.5,53.5,53.5,57,52.5,53,49.5,57,51,52.5,53,54,53,56,60.5,56.5,52,53.5,54.5,55,56.5,53.5,53.5,51.5,54,56,53,56,54,54,55.5,53,54,54,51.5,54,51.5,55,59,55,55,55.5,55,56.5,55.5,55,55.5,53.5,55.5,53.5,53.5,60.5,56.5,55,56,53.5,56.5,55.5,58,54,54,55.5,56,55,56.5,56.5,58,50.5,50.5,53.5,52.5,58.5,59,57,55,57,52,54.5,55.5,60,54,53,54.5,55,56.5,57,53,56.5,58,55.5,54,57,54.5,54.5,54,60,54.5,56.5,56.5,55,56,57,52,56.5,53.5,53,54.5,51,57.5,54,51,55.5,54.5,54.5,55,53,57.5,55.5,53,55,54.5,54,56,52.5,56,54.5,58.5,51.5,53.5,56,58,55,54,58,55.5,53,54,55,54,52.5,53,56,54.5,53.5,52.5,55,51,52,54.5,51,53,54,56,55.5,52,54.5,53,54,58.5,53,56.5,53.5,52,56,51,57.5,54.5,57,52,57,55,55,57,53,50.5,55.5,52.5,51.5,55,54.5,55,50,58.5,55.5,57,51,54,55,52.5,55,54.5,52.5,51,55.5,54.5,56.5,54,54.5,56,58,57.5,58,53.5,62,55.9,58,57.5,54.5,54,55,57,60,52,57.5,53.5],[37.5,38.5,38.5,39,39.5,34.5,38,39.7,39,38,37.5,39.5,38.5,38,38,40,38.5,38.5,38,38,37.5,40.5,38,39.2,38,37.5,38.4,38,38.5,37.5,37.4,38.7,38,41.2,36,38.5,37,38.5,37,36,40.5,37.5,39,36,38,39.5,37.5,38.3,37.8,37,38,39,38,38,39,38,37.5,40.3,40.5,40.3,39,37.5,38.5,38.4,40.5,39.5,37.9,38,39,38,38,39.5,38,36.5,38.5,41,37.5,35.5,36,37,37.5,37.5,38.5,40,37.5,39.5,40,39,38,35.5,37.5,36,38,37,38,39,37,37,37,37.5,39,37,36,40,39,38,37.5,39,38,37,38,38,36.5,35,37,38,36,39,37,34.5,36,36,37.5,38.5,38.5,38,39.5,36,38,40.5,40.5,36.5,37.5,39,36.5,37.5,38,40,37.5,38,36.5,40,37.4,37.2,36.1,36.5,38,37.2,38,37,40.5,37.5,37,35,38.2,40,37.5,37,35,35.5,39,37,37.5,37,39,37,39,37,40.5,38,37,38,37.5,38.5,38,41,36.5,37,36.5,39.5,38,38,39,38,39,37.5,36.5,37,38.5,38,38,39.5,36.5,38.5,36.5,39.5,37,38.5,39,37,38,37,38,36.5,38.5,39,38.5,40,37.5,37,34,37.5,36,36.5,39,38.5,37.5,34.5,36,37.5,39.5,37.5,38.5,34.5,38,35.5,39,39.5,37,38,39,36,34.5,40,39,36,40.5,36,39,37.5,35.5,39,38,39.5,38,36.5,38,37,38,36.5,36.5,36,39.5,37,39.5,37,36.5,37.5,40,38,38.5,37.5,34.5,38.5,39,39,37,37.5,37.5,37,38.5,38.2,35.5,38.5,35.5,39.5,38,37.2,37.5,39,37.5,35,39.5,36.5,40,39,38,39,39.5,35,39,38.5,39.5,36,40,37,37.5,37,39,39,35.5,37,39,39.2,37.5,38,38,37,38.5,38,37,38,37,40,37,39.8,37,36,38,39,38,37.5,37,39,39,38,37,39,37.4,38,36,40,36.5,37,40.5,35.5,37.2,38,38,38.7,36,35.5,38,37.5,37.5,36,40,38.5,40.5,40.5,38.5,38.4,37.5,39,35,39,37.3,36.5,36,37.5,39.5,39.5,39,38,36.5,37.5,38,36,37.5,36.5,36.6,37,38,40.5,37,40,38,39.5,36.5,37.5,37,36.5,38.5,37,40,37.5,40.5,39.5,39,38.5,38,37.5,40,39.5,38,38,37,39,38,39,38,37,34.5,37,36.8,37.5,38.6,39.5,39.5,38.5,38,37.5,38,38,39,36,34.5,37,40,39,39,37.9,39,40.5,39,38.5,39.5,37.5,36.5,38.5,39,36.5,39,40,38,39,40,36,39.5,38,37.5,38.5,35.7,38,38,37,39,37.5,39,39,36.5,40.5,36.5,36.5,38.7,37.5,38,38,38,40,37.5,41,38,37,39,40,36.5,37,39.5,39,38,36.5,37,38,37.5,36,37.5,37.5,40,37.5,38.5,38.5,36.5,36,38.5,36.5,36.5,40,36.5,38,39,38,37,40.5,37,37.5,38,37,39,37,38,37.5,39,36.5,39.5,37,37,38,37,36,37.5,35,35.5,37,38,34.5,36,40.5,37.5,40,36,37.5,38,37.5,38.5,37,37,35.5,38.5,38.5,38.5,36.5,36.5,38,40,39,40,35,39,39,39,37.5,37.5,36,37.5,39.5,40,36,40,37.5],["Female","Female","Male","Male","Male","Female","Female","Male","Male","Male","Female","Female","Female","Female","Female","Male","Male","Male","Male","Female","Female","Female","Male","Male","Female","Female","Female","Female","Male","Female","Female","Female","Female","Male","Female","Female","Female","Male","Female","Male","Male","Male","Female","Female","Female","Male","Male","Female","Female","Female","Male","Male","Male","Female","Male","Male","Male","Male","Male","Female","Male","Female","Female","Male","Male","Male","Female","Female","Male","Female","Male","Male","Female","Female","Male","Male","Male","Female","Female","Male","Female","Female","Female","Male","Female","Female","Female","Male","Female","Male","Female","Male","Female","Female","Male","Male","Female","Male","Male","Female","Male","Female","Female","Male","Male","Female","Male","Male","Male","Male","Male","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Female","Male","Female","Male","Male","Female","Female","Male","Female","Male","Female","Female","Male","Female","Male","Male","Male","Female","Female","Female","Male","Female","Male","Male","Female","Male","Male","Female","Female","Male","Female","Male","Female","Female","Male","Female","Female","Female","Female","Male","Female","Female","Female","Male","Male","Male","Female","Male","Male","Female","Male","Male","Male","Male","Male","Female","Female","Male","Male","Female","Male","Male","Female","Male","Male","Female","Male","Male","Male","Female","Male","Female","Female","Female","Male","Female","Male","Male","Female","Male","Female","Female","Female","Female","Male","Male","Male","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Male","Male","Male","Female","Male","Male","Female","Female","Female","Female","Female","Female","Female","Male","Male","Female","Male","Female","Male","Male","Female","Male","Female","Female","Female","Male","Male","Female","Female","Female","Female","Male","Male","Female","Male","Male","Male","Female","Male","Female","Male","Male","Female","Male","Male","Female","Male","Female","Female","Female","Male","Male","Male","Male","Female","Female","Male","Female","Female","Female","Male","Female","Male","Male","Male","Female","Male","Female","Male","Male","Female","Female","Male","Male","Male","Female","Male","Female","Male","Female","Female","Female","Male","Male","Male","Female","Female","Female","Female","Female","Female","Male","Male","Male","Female","Female","Female","Male","Female","Male","Female","Female","Female","Male","Female","Male","Female","Female","Male","Female","Male","Male","Male","Female","Female","Male","Female","Male","Male","Male","Female","Female","Male","Female","Male","Male","Male","Female","Female","Male","Male","Male","Female","Female","Male","Male","Female","Female","Female","Male","Male","Female","Female","Female","Female","Female","Female","Female","Male","Male","Male","Male","Female","Male","Female","Male","Male","Female","Female","Male","Male","Male","Female","Female","Male","Male","Male","Male","Male","Female","Female","Female","Male","Male","Male","Female","Female","Male","Female","Male","Female","Female","Female","Male","Female","Male","Male","Male","Male","Female","Male","Male","Female","Male","Male","Female","Female","Female","Male","Male","Female","Male","Male","Male","Female","Female","Female","Female","Female","Female","Male","Female","Male","Male","Female","Male","Male","Female","Male","Male","Female","Female","Male","Female","Female","Female","Male","Female","Female","Female","Female","Male","Female","Male","Male","Male","Female","Male","Male","Male","Female","Female","Male","Male","Female","Female","Male","Female","Male","Male","Male","Female","Female","Female","Male","Female","Male","Female","Female","Female","Female","Male","Female","Female","Male","Male","Female","Male","Female","Female","Male","Female","Male","Male","Male","Male","Female","Female","Male","Male","Male","Female","Male","Female","Male","Male","Female","Male","Female","Female","Male","Female","Male","Male","Male","Female","Female","Male","Male","Female","Female","Male","Female","Male","Male","Male","Male","Female","Male","Male","Male","Female","Female","Male","Male","Male","Male","Female","Male","Male","Male","Male","Male","Male","Female","Male","Male","Male","Male","Female"],["tertiary","tertiary","year12","tertiary","year10","tertiary","year10","year10","tertiary","year10","year10","year10","year10","year12","year10","tertiary","year12","year10","tertiary","tertiary","year12","year10","year10","year12","tertiary","tertiary","tertiary","tertiary","year12","tertiary","tertiary","tertiary","year10","year12","year12","year10","year10","tertiary","tertiary","tertiary","year10","year10","year10","year10","year10","year10","year12","year10","tertiary","year10","year10","year12","year12","tertiary","tertiary","year12","year10","tertiary","tertiary","tertiary","tertiary","year12","year12","year10","year10","year12","tertiary","year10","tertiary","year12","year10","tertiary","tertiary","year10","tertiary","year12","year10","year10","year10","year12","tertiary","tertiary","year12","tertiary","tertiary","tertiary","tertiary","year10","tertiary","year10","year10","year10","tertiary","year12","year10","tertiary","year10","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","year10","year10","tertiary","tertiary","year10","year10","tertiary","tertiary","tertiary","tertiary","year10","year10","year10","year12","year10","year10","tertiary","year10","tertiary","year12","year12","year10","tertiary","year10","tertiary","year10","year12","year10","year10","tertiary","year10","tertiary","year10","year10","tertiary","year10","tertiary","year10","tertiary","year12","year10","year10","year12","year10","tertiary","tertiary","tertiary","tertiary","year12","tertiary","year12","tertiary","year10","year10","year10","tertiary","tertiary","year10","year10","year10","tertiary","year10","year10","year12","year12","year10","year10","tertiary","year12","tertiary","year12","year10","tertiary","tertiary","year10","tertiary","year10","tertiary","year10","year10","year12","year10","tertiary","tertiary","tertiary","year10","year10","year12","tertiary","year10","year10","tertiary","year10","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","year10","year10","year10","tertiary","year12","tertiary","year10","year10","tertiary","year10","tertiary","year12","year10","year10","year10","tertiary","year10","tertiary","year12","tertiary","year10","year10","tertiary","year10","year12","tertiary","year10","year10","year12","year10","year12","year12","year12","tertiary","tertiary","year10","year10","year10","year10","year10","tertiary","tertiary","year10","tertiary","tertiary","year12","tertiary","year10","tertiary","year10","year12","year10","tertiary","year10","year10","year10","tertiary","year10","year10","tertiary","year12","year12","tertiary","tertiary","year10","year12","year12","year10","tertiary","tertiary","year12","tertiary","tertiary","tertiary","year12","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","year10","tertiary","year10","tertiary","tertiary","year12","year12","year12","year12","year10","year12","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","year12","tertiary","year10","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","year12","year10","year10","tertiary","year12","tertiary","tertiary","tertiary","year12","tertiary","tertiary","tertiary","tertiary","year10","tertiary","tertiary","year12","tertiary","tertiary","year12","tertiary","year10","year12","tertiary","tertiary","year12","tertiary","tertiary","year10","year12","tertiary","year12","year10","tertiary","year10","year10","tertiary","tertiary","year12","tertiary","tertiary","year10","tertiary","tertiary","year12","tertiary","tertiary","tertiary","year10","year12","year10","year10","year10","tertiary","year12","year10","year10","year10","tertiary","tertiary","tertiary","tertiary","year12","year10","tertiary","tertiary","tertiary","tertiary","tertiary","year10","tertiary","tertiary","year12","tertiary","tertiary","year12","tertiary","tertiary","tertiary","year10","year10","tertiary","year12","year10","tertiary","tertiary","year12","tertiary","year10","year10","tertiary","tertiary","year12","year10","tertiary","year10","tertiary","tertiary","year10","tertiary","tertiary","year12","year12","year10","year12","tertiary","tertiary","tertiary","tertiary","year10","tertiary","year10","tertiary","tertiary","year10","year10","year12","year12","year12","tertiary","year12","year12","tertiary","year10","tertiary","year10","year10","year10","tertiary","year10","tertiary","tertiary","year10","year12","year10","year12","year12","year10","year10","tertiary","tertiary","year10","year12","tertiary","year10","tertiary","year10","year12","year10","year10","tertiary","tertiary","year10","year12","year10","tertiary","tertiary","tertiary","tertiary","year10","tertiary","year10","tertiary","year12","year10","tertiary","year12","year10","tertiary","tertiary","tertiary","year12","year10","tertiary","tertiary","year10","year10","tertiary","tertiary","year10","tertiary","year10","tertiary","year10","tertiary","year10","year10","year10","year10","tertiary","tertiary","tertiary","year12","year12","tertiary","tertiary","year10","year10","tertiary","tertiary","year10","year10","year10","tertiary","year10","tertiary","year10","tertiary","year10","year12","year10","year10","year10","year10","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","year10","tertiary","year12","year10","year10","year12","year12","year10","tertiary","year12","tertiary","year10","tertiary","tertiary","year10","year10","tertiary"],["2 or more siblings","Singleton","2 or more siblings","One sibling","2 or more siblings","Singleton","2 or more siblings","2 or more siblings","2 or more siblings","One sibling","2 or more siblings","2 or more siblings","Singleton","Singleton","One sibling","Singleton","2 or more siblings","One sibling","Singleton","Singleton","One sibling","2 or more siblings","2 or more siblings","Singleton","One sibling","Singleton","One sibling","Singleton","Singleton","Singleton","Singleton","Singleton","Singleton","One sibling","Singleton","Singleton","2 or more siblings","2 or more siblings","One sibling","Singleton","One sibling","Singleton","Singleton","One sibling","2 or more siblings","One sibling","2 or more siblings","2 or more siblings","Singleton","Singleton","2 or more siblings","One sibling","One sibling","2 or more siblings","Singleton","Singleton","2 or more siblings","Singleton","Singleton","Singleton","Singleton","Singleton","One sibling","One sibling","2 or more siblings","One sibling","One sibling","2 or more siblings","2 or more siblings","2 or more siblings","One sibling","One sibling","Singleton","One sibling","Singleton","One sibling","One sibling","Singleton","Singleton","One sibling","Singleton","One sibling","Singleton","2 or more siblings","Singleton","2 or more siblings","One sibling","One sibling","One sibling","2 or more siblings","One sibling","One sibling","2 or more siblings","One sibling","One sibling","Singleton","One sibling","Singleton","One sibling","Singleton","2 or more siblings","Singleton","2 or more siblings","2 or more siblings","Singleton","Singleton","One sibling","One sibling","Singleton","Singleton","Singleton","One sibling","One sibling","One sibling","One sibling","One sibling","Singleton","2 or more siblings","Singleton","2 or more siblings","2 or more siblings","Singleton","Singleton","One sibling","One sibling","2 or more siblings","2 or more siblings","Singleton","2 or more siblings","2 or more siblings","One sibling","2 or more siblings","2 or more siblings","2 or more siblings","Singleton","One sibling","2 or more siblings","Singleton","One sibling","One sibling","One sibling","2 or more siblings","Singleton","Singleton","Singleton","One sibling","One sibling","Singleton","Singleton","Singleton","2 or more siblings","2 or more siblings","One sibling","2 or more siblings","One sibling","One sibling","Singleton","2 or more siblings","One sibling","Singleton","2 or more siblings","2 or more siblings","One sibling","Singleton","One sibling","2 or more siblings","One sibling","Singleton","Singleton","Singleton","Singleton","One sibling","Singleton","2 or more siblings","One sibling","One sibling","Singleton","2 or more siblings","2 or more siblings","2 or more siblings","2 or more siblings","2 or more siblings","One sibling","Singleton","One sibling","Singleton","2 or more siblings","Singleton","One sibling","One sibling","One sibling","One sibling","One sibling","2 or more siblings","One sibling","2 or more siblings","Singleton","2 or more siblings","Singleton","One sibling","One sibling","Singleton","2 or more siblings","Singleton","2 or more siblings","Singleton","One sibling","One sibling","2 or more siblings","2 or more siblings","Singleton","2 or more siblings","Singleton","Singleton","2 or more siblings","One sibling","2 or more siblings","2 or more siblings","Singleton","Singleton","One sibling","One sibling","One sibling","Singleton","2 or more siblings","2 or more siblings","2 or more siblings","2 or more siblings","2 or more siblings","One sibling","2 or more siblings","One sibling","2 or more siblings","Singleton","2 or more siblings","One sibling","One sibling","Singleton","2 or more siblings","2 or more siblings","Singleton","One sibling","One sibling","2 or more siblings","Singleton","Singleton","2 or more siblings","One sibling","One sibling","One sibling","One sibling","Singleton","2 or more siblings","2 or more siblings","Singleton","2 or more siblings","2 or more siblings","Singleton","2 or more siblings","One sibling","2 or more siblings","Singleton","Singleton","One sibling","Singleton","One sibling","2 or more siblings","Singleton","One sibling","Singleton","One sibling","2 or more siblings","Singleton","Singleton","One sibling","One sibling","One sibling","One sibling","One sibling","2 or more siblings","One sibling","One sibling","2 or more siblings","Singleton","Singleton","2 or more siblings","One sibling","One sibling","Singleton","Singleton","One sibling","Singleton","2 or more siblings","Singleton","Singleton","Singleton","One sibling","Singleton","Singleton","Singleton","One sibling","One sibling","One sibling","One sibling","One sibling","One sibling","One sibling","Singleton","Singleton","One sibling","One sibling","Singleton","2 or more siblings","2 or more siblings","2 or more siblings","2 or more siblings","2 or more siblings","Singleton","One sibling","Singleton","One sibling","2 or more siblings","Singleton","Singleton","2 or more siblings","2 or more siblings","2 or more siblings","2 or more siblings","One sibling","One sibling","Singleton","Singleton","One sibling","2 or more siblings","2 or more siblings","Singleton","2 or more siblings","One sibling","One sibling","2 or more siblings","2 or more siblings","One sibling","2 or more siblings","One sibling","Singleton","One sibling","One sibling","2 or more siblings","Singleton","Singleton","Singleton","2 or more siblings","One sibling","One sibling","One sibling","2 or more siblings","2 or more siblings","Singleton","One sibling","2 or more siblings","One sibling","One sibling","One sibling","One sibling","Singleton","2 or more siblings","One sibling","One sibling","2 or more siblings","2 or more siblings","One sibling","Singleton","2 or more siblings","Singleton","One sibling","One sibling","Singleton","2 or more siblings","One sibling","Singleton","One sibling","Singleton","2 or more siblings","Singleton","One sibling","Singleton","One sibling","One sibling","Singleton","Singleton","Singleton","One sibling","2 or more siblings","2 or more siblings","2 or more siblings","Singleton","2 or more siblings","Singleton","One sibling","Singleton","One sibling","2 or more siblings","2 or more siblings","Singleton","One sibling","One sibling","One sibling","Singleton","2 or more siblings","2 or more siblings","One sibling","One sibling","2 or more siblings","2 or more siblings","2 or more siblings","Singleton","Singleton","2 or more siblings","Singleton","2 or more siblings","One sibling","Singleton","2 or more siblings","One sibling","2 or more siblings","One sibling","One sibling","Singleton","One sibling","One sibling","2 or more siblings","Singleton","Singleton","Singleton","2 or more siblings","One sibling","2 or more siblings","2 or more siblings","One sibling","One sibling","Singleton","2 or more siblings","One sibling","2 or more siblings","Singleton","Singleton","Singleton","One sibling","One sibling","2 or more siblings","One sibling","2 or more siblings","Singleton","Singleton","Singleton","2 or more siblings","2 or more siblings","2 or more siblings","Singleton","One sibling","One sibling","2 or more siblings","2 or more siblings","2 or more siblings","Singleton","2 or more siblings","Singleton","One sibling","Singleton","One sibling","Singleton","2 or more siblings","One sibling","2 or more siblings","Singleton","2 or more siblings","One sibling","Singleton","2 or more siblings","One sibling","2 or more siblings","One sibling","One sibling","Singleton","One sibling","2 or more siblings","One sibling","2 or more siblings","2 or more siblings","Singleton","One sibling","2 or more siblings","Singleton","2 or more siblings","Singleton","Singleton","Singleton","2 or more siblings","2 or more siblings","Singleton","Singleton","Singleton","Singleton","One sibling","One sibling","One sibling","Singleton","One sibling","One sibling","2 or more siblings","Singleton","2 or more siblings","2 or more siblings","Singleton","2 or more siblings","2 or more siblings","One sibling","One sibling","One sibling","Singleton","2 or more siblings","One sibling","2 or more siblings","One sibling","One sibling","One sibling","2 or more siblings","Singleton","Singleton","One sibling","One sibling","One sibling","2 or more siblings","2 or more siblings","One sibling","One sibling","2 or more siblings","2 or more siblings","2 or more siblings","2 or more siblings","One sibling","Singleton","Singleton","Singleton","2 or more siblings","2 or more siblings","Singleton","One sibling","2 or more siblings","2 or more siblings"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>weight<\/th>\n      <th>height<\/th>\n      <th>headc<\/th>\n      <th>gender<\/th>\n      <th>education<\/th>\n      <th>parity<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"deferRender":false,"dom":"Bt","scrollY":452,"scroller":true,"scrollX":true,"pageLength":10,"buttons":[{"extend":"csv","filename":"BirthWeight"}],"columnDefs":[{"className":"dt-right","targets":[0,1,2]},{"name":"weight","targets":0},{"name":"height","targets":1},{"name":"headc","targets":2},{"name":"gender","targets":3},{"name":"education","targets":4},{"name":"parity","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-BirthWeight0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.2: Table with raw data.
</figcaption>
</figure>
</div>
</div>
<p>Open the dataset named “BirthWeight” from the file tab in the menu.</p>
<div id="fig-BirthWeight1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-BirthWeight1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/BirthWeight1.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-BirthWeight1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.3: The BirthWeight dataset.
</figcaption>
</figure>
</div>
<p>Data of 550 infants at 1 month age was collected. The following variables were recorded (<a href="#fig-BirthWeight1" class="quarto-xref">Figure&nbsp;<span>6.3</span></a>):</p>
<p>• Body weight of the infant in g (weight)</p>
<p>• Body height of the infant in cm (height)</p>
<p>• Head circumference in cm (headc)</p>
<p>• Gender of the infant (gender: Female, Male)</p>
<p>• Birth order in their family (parity: Singleton, One sibling, 2 or more siblings)</p>
<p>• Education of the mother (education: tertiary, year10, year12)</p>
</section>
<section id="simultaneous-regression" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="simultaneous-regression"><span class="header-section-number">6.5</span> Simultaneous Regression</h2>
<p>First, we will include all available explanatory variables and assess model fit based on this complete model.</p>
<p>On the Jamovi top menu navigate to</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  A(Analyses) -.-&gt; B(Regression) -.-&gt; C(Linear Regression)
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>as shown below (<a href="#fig-scat4" class="quarto-xref">Figure&nbsp;<span>6.4</span></a>).</p>
<div id="fig-scat4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scat4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/scat4.png" class="img-fluid figure-img" style="width:65.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scat4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.4: In the menu at the top, choose Analyses &gt; Regression <img src="images/reg_icon.png" width="35" height="33" class="figure-img"> &gt; Linear Regression.
</figcaption>
</figure>
</div>
<p>The <em>Linear Regression dialogue box</em> opens (<a href="linear1.html#fig-scat5" class="quarto-xref">Figure&nbsp;<span>5.8</span></a>). From the left-hand pane drag the variable <code>weight</code> into the <em>Dependent Variable</em> field, the variables <code>height</code> and <code>headc</code> into the <em>Covariates</em> field, and the variables <code>gender</code>, <code>parity</code>, and <code>education</code> into the <em>factors</em> field on the right-hand side, as shown below (<a href="#fig-mlinear1" class="quarto-xref">Figure&nbsp;<span>6.5</span></a>):</p>
<div id="fig-mlinear1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear1.png" class="img-fluid figure-img" style="width:65.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.5: The Linear Regression dialogue box options. Drag and drop the variables in the fields on the right-hand side.
</figcaption>
</figure>
</div>
<p>We also set reference groups for the categorical variables from the <strong>Reference Level</strong> box: “Female” for the <code>gender</code> variable, “Singleton” for the <code>parity</code> variable, and “year10” for the education variable.</p>
<div id="fig-mlinear1b" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear1b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear1b.png" class="img-fluid figure-img" style="width:65.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear1b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.6: Reference Level box. Specify the reference group for the categorical variables.
</figcaption>
</figure>
</div>
<section id="assumptions" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1" class="anchored" data-anchor-id="assumptions"><span class="header-section-number">6.5.1</span> Assumptions</h3>
<p>Specific assumptions have to be met for reliable hypothesis testing and confidence intervals in linear regression: independence of the residuals, linearity and homoscedasticity of the data, normality of the residuals, no multicollinearity and outliers. We will describe some statistical tests and diagnostic plots in Jamovi for testing the assumptions underlying linear regression model.</p>
<p>From the <strong>Assumption Checks</strong> section tick the all the boxes and from the <strong>Data Summary</strong> the “Cook’s distance” (<a href="#fig-mlinear3" class="quarto-xref">Figure&nbsp;<span>6.7</span></a>):</p>
<div id="fig-mlinear3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear3.png" class="img-fluid figure-img" style="width:65.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.7: Assumption Checks choices.
</figcaption>
</figure>
</div>
<p>&nbsp;</p>
<p><strong>Independence of residuals</strong></p>
<p>The independence of residuals assumption means that for any two observations, the residual terms should be uncorrelated (or independent).</p>
<div id="fig-mlinear5" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear5.png" class="img-fluid figure-img" style="width:45.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.8: The Durbin-Watson test.
</figcaption>
</figure>
</div>
<p>The Durbin-Watson test assesses whether the residuals from a regression model are independent—that is, whether there is autocorrelation. Ideally, the Durbin-Watson statistic should be close to 2. Values significantly below 1 or above 3 suggest a violation of the independence assumption. In our case, the Durbin-Watson statistic is 1.83, which is close to 2, indicating no evidence of problematic autocorrelation.</p>
<p>&nbsp;</p>
<p><strong>Linearity and homoscedasticity of the data</strong></p>
<p>To examine linearity and homoscedasticity we examine the Residuals vs Fitted value Plot.</p>
<div id="fig-mlinear8" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear8.png" class="img-fluid figure-img" style="width:55.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.9: Residuals vs Fitted values plot.
</figcaption>
</figure>
</div>
<p>We would expect to see a random scatter of points around zero on the y-axis. In our example, the residuals appear randomly dispersed in a cloud-like pattern, which indicates that the assumption of linearity and homoscedasticity is satisfied.</p>
<blockquote class="blockquote">
<p>If the residuals display a pattern—such as being more spread out at the ends and tighter in the middle (a bow tie shape), or more spread out on one side of the x-axis and tighter on the other (a funnel or fan shape)—this suggests heteroscedasticity. In such cases, the assumption of homoscedasticity is violated.</p>
</blockquote>
<div id="fig-mlinear9" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear9.png" class="img-fluid figure-img" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.10: Homoscedasticity Vs heteroscedasticity.
</figcaption>
</figure>
</div>
<p>&nbsp;</p>
</section>
<section id="normality-of-the-residuals" class="level3" data-number="6.5.2">
<h3 data-number="6.5.2" class="anchored" data-anchor-id="normality-of-the-residuals"><span class="header-section-number">6.5.2</span> Normality of the residuals</h3>
<p>The check normality of the residuals with the Shapiro-Wilk’s test and the normal Q-Q plot of the residuals.</p>
<div id="fig-mlinear6" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear6.png" class="img-fluid figure-img" style="width:30.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.11: The Durbin-Watson test.
</figcaption>
</figure>
</div>
<p>Note that this test almost always yields significant results for the distribution of residuals for large samples and visual inspection (e.g., Q-Q plots) are preferable.</p>
<div id="fig-mlinear7" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear7.png" class="img-fluid figure-img" style="width:55.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.12: The Durbin-Watson test.
</figcaption>
</figure>
</div>
<p>The <a href="#fig-mlinear7" class="quarto-xref">Figure&nbsp;<span>6.12</span></a> shows no significant deviation from normality.</p>
<p>&nbsp;</p>
</section>
<section id="no-multicollinearity" class="level3" data-number="6.5.3">
<h3 data-number="6.5.3" class="anchored" data-anchor-id="no-multicollinearity"><span class="header-section-number">6.5.3</span> No multicollinearity</h3>
<p>This assumption means there should be no perfect or near-perfect linear relationship between two or more of the explanatory variables (predictors) in our regression model. Multicollinearity is a problem for three reasons:</p>
<ol type="1">
<li><p>Untrustworthy <span class="math inline">\(b\)</span>: As multicollinearity increases, so do the standard errors of the <span class="math inline">\(b\)</span> coefficients. We want smaller standard errors, so this is problematic.</p></li>
<li><p>Limits the size of R, and therefore the size of <span class="math inline">\(R^2\)</span>, and we want to have the largest <span class="math inline">\(R^2\)</span> possible, given our data.</p></li>
<li><p>Importance of explanatory variables (predictors): When two explanatory variables are highly correlated, it is very hard to determine which variable is more important than the other.</p></li>
</ol>
<p>To test for multicollinearity, we examine the VIF and Tolerance values. VIF is actually a transformation of Tolerance (Tolerance = 1/VIF). In general, we want VIF values 5 or lower, which corresponds to Tolerance values greater than (1/5) 0.2.</p>
<div id="fig-mlinear10" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear10.png" class="img-fluid figure-img" style="width:35.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.13: VIF.
</figcaption>
</figure>
</div>
<p>In our data, the VIF values satisfy the assumption of no multicollinearity.</p>
<p>&nbsp;</p>
<div class="content-box-blue">
<p><strong>Proposed remedies for multicollinearity</strong></p>
<p>• <strong>Increase the sample size:</strong> A larger sample can reduce the standard errors of the coefficient estimates, thereby improving the precision and stability of the model.</p>
<p>• <strong>Model respecification:</strong> Remove some of the highly associated explanatory variables or replace them with a linear combination of them (if possible).</p>
<p>• <strong>Regularization (Tolerant) techniques:</strong> Some regression techniques may be more sensitive to multicollinearity than others. Recent developments in model selection methods have introduced new methods for balancing model complexity and fit. For example two special linear regression model — Lasso and Ridge regression. Although not necessarily designed to be tolerant of collinearity, they offer approaches that may be less sensitive.</p>
<p>• <strong>Principal Component Regression: </strong>This technique transforms the original correlated variables into a smaller set of uncorrelated components and uses them in the regression, effectively addressing multicollinearity.</p>
<p>• <strong>Change the reference category for categorical variables:</strong> In cases where multicollinearity arises from dummy variables, selecting a different reference category can sometimes alleviate the problem.</p>
</div>
</section>
<section id="no-outliers-that-influence-the-model-influential-points" class="level3" data-number="6.5.4">
<h3 data-number="6.5.4" class="anchored" data-anchor-id="no-outliers-that-influence-the-model-influential-points"><span class="header-section-number">6.5.4</span> No outliers that influence the model (influential points)</h3>
<p>There shouldn’t be any data point in the dataset that is an outlier which would strongly influence our results.</p>
<p>Outliers are points that fall away from the cloud of points. Outliers that actually influence the parameters of the regression model are called <strong>influential points</strong>. Therefore, not all outliers are influential in linear regression analysis. Even though data have extreme values, they might not be influential to determine a regression model. That means, the results wouldn’t be much different if we either include or exclude them from analysis.</p>
<p>Cook’s distance is a measure used to identify influential data points in regression analysis. In general, Cook’s distances greater than 1 indicate an outlier that may influence the model.</p>
<div id="fig-mlinear11" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear11-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear11.png" class="img-fluid figure-img" style="width:45.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear11-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.14: Cook’s distance.
</figcaption>
</figure>
</div>
<p>Our Cook’s distances are very small, so we do not have a problem with outliers.</p>
<p>&nbsp;</p>
</section>
<section id="the-model-fit-and-coefficients" class="level3" data-number="6.5.5">
<h3 data-number="6.5.5" class="anchored" data-anchor-id="the-model-fit-and-coefficients"><span class="header-section-number">6.5.5</span> The model fit and coefficients</h3>
<p>From the <em>Model Fit</em> section tick the box “<strong>Adjusted</strong> <span class="math inline">\(R^2\)</span>” in <strong>Fit Measures</strong> (<a href="#fig-linear4" class="quarto-xref">Figure&nbsp;<span>6.16</span></a>):</p>
<div id="fig-linear4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linear4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear4.png" class="img-fluid figure-img" style="width:55.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linear4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.15: Adjusted R square.
</figcaption>
</figure>
</div>
<p>Additionally, from the <em>Model Coefficients</em> section tick the box “<strong>Confidence interval</strong>” in <strong>Estimate</strong> (<a href="#fig-linear4" class="quarto-xref">Figure&nbsp;<span>6.16</span></a>):</p>
<div id="fig-linear4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linear4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/linear4.png" class="img-fluid figure-img" style="width:55.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linear4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.16: Check the Confidence interval box in the Model Coefficients section.
</figcaption>
</figure>
</div>
<p><strong>Adjusted R-squared:</strong> This metric adjusts the R-squared value to account for the number of explanatory variables (predictors) in the model.</p>
<div id="fig-mlinear13" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear13.png" class="img-fluid figure-img" style="width:45.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.17: The model coefficients table.
</figcaption>
</figure>
</div>
<p>About 59% of the variation in infant’s body weight can be explained by the independent variables (such as <code>height</code>, <code>head circumference</code>, <code>gender</code>, etc.) in the model.</p>
<p>&nbsp;</p>
<p>The output table with the model coefficients should look like the following (<a href="#fig-mlinear12" class="quarto-xref">Figure&nbsp;<span>6.18</span></a>):</p>
<div id="fig-mlinear12" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear12.png" class="img-fluid figure-img" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.18: The model coefficients table.
</figcaption>
</figure>
</div>
<p>The equation of our model with all variables is:</p>
<p><span class="math display">\[\begin{align}
\widehat{Weight} &amp;= -7082 + 131 \cdot height + 109 \cdot headc + 196 \cdot gender \\
&amp;\quad +\ 76 \cdot parity1 + 96 \cdot parity2 - 35 \cdot edu1 - 36 \cdot edu2
\end{align}\]</span></p>
<p>All variables in the model are statistically significant except for the comparison between infants with two or more siblings and singletons (p = 0.06), as well as the mother’s education level (year12-year10, p = 0.47; tertiary-year10 p = 0.33).</p>
<p>&nbsp;</p>
</section>
</section>
<section id="hierarchical-regression" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="hierarchical-regression"><span class="header-section-number">6.6</span> Hierarchical regression</h2>
<p>First, we check Akaike Information Criterion (AIC) from the <strong>Model Fit</strong> (<a href="#fig-mlinear14" class="quarto-xref">Figure&nbsp;<span>6.19</span></a>).</p>
<div id="fig-mlinear14" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear14-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear14.png" class="img-fluid figure-img" style="width:65.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear14-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.19: Akaike Information Criterion (AIC).
</figcaption>
</figure>
</div>
<p>The AIC is a statistical measure used to evaluate the goodness of fit of a model while penalizing for the number of parameters used. It helps compare different models and choose the one that best balances model fit and complexity. A lower AIC indicates a better model.</p>
<section id="model-1" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="model-1"><span class="header-section-number">6.6.1</span> Model 1</h3>
<p>We can specify hierarchical regression using the Model Builder drop-down menu in jamovi (<a href="#fig-mlinear2" class="quarto-xref">Figure&nbsp;<span>6.20</span></a>). Let’s select <code>height</code> and <code>gender</code> variables (predictors) as <strong>Block 1</strong> (Model 1).</p>
<div id="fig-mlinear2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear2.png" class="img-fluid figure-img" style="width:65.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.20: Model builder: Block 1.
</figcaption>
</figure>
</div>
<div id="fig-mlinear15" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear15-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear15.png" class="img-fluid figure-img" style="width:55.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear15-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.21: Model fit table.
</figcaption>
</figure>
</div>
<p>About 55% of the variation in infant’s body weight can be explained by <code>height</code> and <code>gender</code> in the model 1.</p>
<p>&nbsp;</p>
<p>The output table with the model coefficients should look like the following (<a href="#fig-mlinear16" class="quarto-xref">Figure&nbsp;<span>6.22</span></a>):</p>
<div id="fig-mlinear16" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear16.png" class="img-fluid figure-img" style="width:65.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.22: Model 1 coefficients table.
</figcaption>
</figure>
</div>
<p>The equation of model 1 is:</p>
<p><span class="math display">\[\widehat{Weight} = -4814 + 165 \cdot height + 251 \cdot gender\]</span></p>
<p>Both variables in the model are statistically significant (p&lt;0.001).</p>
</section>
<section id="model-2" class="level3" data-number="6.6.2">
<h3 data-number="6.6.2" class="anchored" data-anchor-id="model-2"><span class="header-section-number">6.6.2</span> Model 2</h3>
<p>Next, we select <strong>Add New Block</strong> and include the <code>headc</code> and <code>parity</code> variables in <strong>Block 2</strong> (Model 2).</p>
<div id="fig-mlinear17" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear17-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear17.png" class="img-fluid figure-img" style="width:40.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear17-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.23: Model builder: Block 2.
</figcaption>
</figure>
</div>
<div id="fig-mlinear18" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear18-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear18.png" class="img-fluid figure-img" style="width:55.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear18-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.24: Model fit table.
</figcaption>
</figure>
</div>
<p>Model 2 explains approximately 59% of the variation in infant body weight using the variables <code>height</code>, <code>gender</code>, <code>headc</code>, and <code>parity</code>, compared to 55% in Model 1 (<span class="math inline">\(\Delta R_{adj}^2 = 0.04\)</span> or 4%). Additionally, the AIC of Model 2 (8115) is lower than that of Model 1 (8169), indicating that Model 2 has a better fit.</p>
<p>&nbsp;</p>
<p>The output table with the new model coefficients should look like the following (<a href="#fig-mlinear19" class="quarto-xref">Figure&nbsp;<span>6.25</span></a>):</p>
<div id="fig-mlinear19" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear19-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear19.png" class="img-fluid figure-img" style="width:65.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear19-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.25: Model 2 coefficients table.
</figcaption>
</figure>
</div>
<p>The equation of model 2 is:</p>
<p><span class="math display">\[\begin{align}
\widehat{Weight} &amp;= -7072 + 130 \cdot height + 197 \cdot gender + 110 \cdot headc \\
&amp;\quad +\ 82 \cdot parity1 + 105 \cdot parity2
\end{align}\]</span></p>
<p>All variables in the model are statistically significant (p&lt;0.05).</p>
</section>
<section id="model-3" class="level3" data-number="6.6.3">
<h3 data-number="6.6.3" class="anchored" data-anchor-id="model-3"><span class="header-section-number">6.6.3</span> Model 3</h3>
<p>Finally, we select <strong>Add New Block</strong> and include the <code>education</code> variable in <strong>Block 3</strong> (Model 3).</p>
<div id="fig-mlinear20" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear20-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear20.png" class="img-fluid figure-img" style="width:40.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear20-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.26: Model builder: Block 3.
</figcaption>
</figure>
</div>
<div id="fig-mlinear21" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear21-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear21.png" class="img-fluid figure-img" style="width:55.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear21-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.27: Model fit table.
</figcaption>
</figure>
</div>
<p>Model 3 does not explain more variation than Model 2. Additionally, the AIC of Model 3 (8118) is greater than that of Model 2 (8115), indicating that Model 3 provides a worse fit.</p>
<p>&nbsp;</p>
<p>The output table with the new model coefficients should look like the following (<a href="#fig-mlinear19" class="quarto-xref">Figure&nbsp;<span>6.25</span></a>):</p>
<div id="fig-mlinear22" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear22-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear22.png" class="img-fluid figure-img" style="width:65.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear22-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.28: Model 3 coefficients table.
</figcaption>
</figure>
</div>
<p>The equation of model 3 is:</p>
<p><span class="math display">\[\begin{align}
\widehat{Weight} &amp;= -7082 + 131 \cdot height + 109 \cdot headc + 196 \cdot gender \\
&amp;\quad +\ 76 \cdot parity1 + 96 \cdot parity2 - 35 \cdot edu1 - 36 \cdot edu2
\end{align}\]</span></p>
<p><strong>NOTE:</strong> This model is the complete that we have previously explored.</p>
</section>
</section>
<section id="model-with-interaction" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="model-with-interaction"><span class="header-section-number">6.7</span> Model with interaction</h2>
<p>Finally, we remove education from Block 3 and add the interaction term between <code>height</code> and <code>gender</code>.</p>
<div id="fig-mlinear23" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear23-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear23.png" class="img-fluid figure-img" style="width:40.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear23-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.29: Model builder: Block 3.
</figcaption>
</figure>
</div>
<div id="fig-mlinear24" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear24-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear24.png" class="img-fluid figure-img" style="width:55.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear24-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.30: Model fit table.
</figcaption>
</figure>
</div>
<p>The AIC of Model 3 (8101) is lower than that of Model 2 (8115), indicating that Model 3 with the interaction term has a better fit.</p>
<p>&nbsp;</p>
<p>The output table with the new model coefficients should look like the following (<a href="#fig-mlinear19" class="quarto-xref">Figure&nbsp;<span>6.25</span></a>):</p>
<div id="fig-mlinear25" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mlinear25-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/mlinear25.png" class="img-fluid figure-img" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlinear25-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.31: Model 3 coefficients table.
</figcaption>
</figure>
</div>
<p>The interaction term is statistically significant (Estimate = 57, p &lt; 0.001), suggesting that the effect of height on body weight differs by gender. This indicates <strong>effect modification</strong> (also known as a moderation effect), where gender alters the strength of the association between height and body weight.</p>
<p>The equation of model 3 with the interaction term is:</p>
<p><span class="math display">\[\begin{align}
\widehat{Weight} &amp;= -5299 + 98 \cdot height + 108 \cdot headc -2921 \cdot gender \\
&amp;\quad +\ 91 \cdot parity1 + 116 \cdot parity2 + 57 \cdot heigh * gender
\end{align}\]</span></p>
<p>In this case, the main effects of height and gender are not interpreted independently, as the interaction term modifies their meanings. Specifically:</p>
<ul>
<li>For females (reference; gender = 0):</li>
</ul>
<p><span class="math display">\[\begin{align}
\widehat{Weight} &amp;= -5299 + 98 \cdot height + 108 \cdot headc -2921 \cdot 0 \\
&amp;\quad +\ 91 \cdot parity1 + 116 \cdot parity2 + 57 \cdot heigh * 0
\end{align}\]</span> <span class="math display">\[\begin{align}
\widehat{Weight} &amp;= -5299 + 98 \cdot height + 108 \cdot headc + 91 \cdot parity1 + 116 \cdot parity2
\end{align}\]</span></p>
<p>Thus, the effect of height on body weight is 98 g.</p>
<ul>
<li>For males (gender = 1):</li>
</ul>
<p><span class="math display">\[\begin{align}
\widehat{Weight} &amp;= -5299 + 98 \cdot height + 108 \cdot headc -2921 \cdot 1 \\
&amp;\quad +\ 91 \cdot parity1 + 116 \cdot parity2 + 57 \cdot heigh * 1
\end{align}\]</span> <span class="math display">\[\begin{align}
\widehat{Weight} &amp;= -8220 + (98 + 57) \cdot height + 108 \cdot headc + 91 \cdot parity1 + 116 \cdot parity2 \\
\end{align}\]</span></p>
<p>Thus, the effect of height is 98 + 57 = 155 g.</p>
<p>This implies that height has a stronger influence on weight for males than for females.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./linear1.html" class="pagination-link" aria-label="Linear regression (1)">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Linear regression (1)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./presentations.html" class="pagination-link" aria-label="Presentations">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Presentations</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2024, Konstantinos I. Bougioukas. License: <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivs 4.0</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a><sup>®</sup></p>
</div>
  </div>
</footer>




</body></html>